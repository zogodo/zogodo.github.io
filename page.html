<!DOCTYPE html>

<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="author" content="zogodo">
    <meta name="description" content="旁敲侧击, 投其所好, 欲擒故纵, 不送人头!">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <title>一木东のBlog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen"> -->
    <link rel="stylesheet" type="text/css" href="stylesheets/googleapis.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen"> <!-- md to html -->
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/gitalk.css" media="screen">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
    <link rel="stylesheet" href="highlight/github-gist.css"> <!-- md to html 代码高亮补丁 -->
</head>
<body ng-app="myApp" ng-controller="myCtrl">
    <div id="menu"></div>

    <section class="main-content">
        <div id="content">
            <div id="cnt_div">{{content}}</div>
        </div>

        <div id="comment">
            <div id="gitalk-container"></div>
        </div>

        <footer class="site-footer">
            <span class="site-footer-credits">
                Copyright © 2019
                <a href="index.html">一木东のBlog</a>.
                <a target="_blank" href="md/{{gitalk_id}}.md">下载文章</a>
                <br/>
                Generated by
                <a target="_blank" href="https://pages.github.com">Github Pages</a>.</span>
        </footer>
    </section>
</body>

<!-- <script async src="js/jquery-3.0.0.min.js"></script> -->
<script src="js/angular.min.js"></script>
<!-- <script async src="js/jquery.form.js"></script> -->
<script async src="js/showdown.js"></script> <!-- md to html -->
<script async src="highlight/highlight.pack.js"></script> <!-- md to html 代码高亮补丁 -->
<script src="js/my_tool.js"></script>
<!-- <script async src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> -->
<script src="js/gitalk.min.js"></script>
<script>
    var gitalk_id = getURLParameter("id");
    if (gitalk_id == null) gitalk_id = "index";
    //window.history.pushState({}, 0, "page.html"); //修改url

    var app = angular.module('myApp', []);
    app.controller('myCtrl', function($scope, $http) {
        $scope.gitalk_id = gitalk_id;
        var cnt_div = document.getElementById("cnt_div");

        url = "md/"+gitalk_id+".md";
        if (gitalk_id == "va") {
            url = "https://raw.githubusercontent.com/zogodo/SandVXposed/master/doc/VirtualApp%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.md"
        }
        if (gitalk_id == "zbox") {
            url = "https://raw.githubusercontent.com/zogodo/zBox/refs/heads/master/README.md"
        }
        $http.get(url).then(function(re) {
            $scope.content = re.data;
            WriteMd(cnt_div, $scope.content);
            WriteMenu();
        }, function(re) {
            $scope.content = "# 101 + 101 + 101 + 101 = 404\n```cpp\nint a = 404;\n```\n";
            WriteMd(cnt_div, $scope.content);
            WriteMenu();
        });
        $scope.ParseTime = function (timeStr) {
            return Date.parse(timeStr);
        };
        $scope.GetAnnexName = function(path) {
            if (path == null || path == "") return "";
            return path.substring(52);
        }
    });
    function WriteMenu() {
        var hs = content.querySelectorAll("h1,h2,h3,h4,h5,h6");
        var menus = "";
        for (var i = 0; i < hs.length; i++) {
            menus += `<a href='#${hs[i].id}' class='${hs[i].tagName}'>${hs[i].innerHTML}</a><br/>`;
        }
        document.getElementById("menu").innerHTML = menus;
    }
    const gitalk = new Gitalk({
        clientID: 'aed518bcf2b6a0edd12c',
        clientSecret: '59243b048303e8628864cae9d521699b4b579548',
        repo: 'zogodo.github.io',
        owner: 'zogodo',
        admin: ['zogodo'],
        id: gitalk_id,
        language: "zh-CN"
    });
	gitalk.render('gitalk-container');
</script>

</html>
